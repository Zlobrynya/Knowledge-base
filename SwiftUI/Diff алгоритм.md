View в SwiftUI можно разделить на 2 типа: Primitive и Composed

Primitive views - примитивы которые предоставляет SwiftUI для верстки интерфейсов
Их можно разделить на 4 типа:
1. **Unary views** - view которые фактически отображаются на экране: Text, Color, Shape и т.д
2. **Structural views** - view которые могут приминать от 0 до n других view и комбинировать их в подмножество отображаемых view. Например: ForEach, EmptyView и view которые используют ViewBuilder
3. **Container views** - view которые отображают другие view, а так же управляют их отображением: List, ScrollView,  \_Stack. Особенность: всегда виден как "отображаемое" view, для контейнера выше.
4. **Modifiers** - view которые берут другое view и изменяют верстку других view, padding, border и т.п

### The runtime view graph 

Структура графа может изменяться только ограниченным количеством способов, и все эти способы строго описывают Structural views:
1. \_ConditionalView может отображать либо TrueContent, либо FalseContent. Эта вью появляется, когда мы используем if else.
2. ForEach изменяется в зависимости от изменений в данных. Именно поэтому он требует, чтобы эти данные соответствовали Identifiable. Но самое главное, что тип сабвью всегда остается неизменным.
3. Если изменяется тип вью обернутой в AnyView, то весь ее контент будет удален и создан новый.
4. Optional\<View> отображает либо View, либо ничего. Обычно такая вью возникает когда мы использует if без ветви else.
Во всех четырех случаях целые ветви графа удаляются или добавляются, потому что отношения между вершинами графа не могут быть изменены иначе. Нельзя добавить или удалить еще один модификатор или переместить вью к другому родителю.

### The diffing algorithm

Алгоритм вычисления идет с первой изменившейся view и ниже по графу, обновляя все view, которые изменились.
1. Unary views - тут все просто, так как это конечная view, которая просто отображается, тут достаточно проверить, что value во view отличная от того что была 
2. Container views - т.к эти view, не могут менять graph (см. выше), то тут следует проверить subview на изменения.
3.  Structural views - Возьмем для примера \_ConditionalView. Если его условие изменилось, то нужно удалить все старые displayables связанные с прошлым контентом и добавить новые .Если условие осталось прежним, то только текущий контент мог измениться и нужно лишь проверить, что, например, старый TrueContent равен новому, и если нет, то продолжить рекурсивно обновлять view graph для TrueContent.



  



Ссылки:
https://rensbr.eu/blog/swiftui-diffing/
https://t.me/fckncoding/35 
https://developer.apple.com/videos/play/wwdc2023/10160/?time=804